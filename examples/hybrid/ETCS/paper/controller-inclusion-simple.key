/**
 * Safety lemma for European Train Control System
 * @PROVABLE using interactions enforcing candidate use and hiding superfluous SB constraint in diffind step.
 */
\functions {
R b;
R A;
R ep;
}

\problem {
\[ R vdes, SB, mo, t, a, v, z, m, d, do, drive, brake, state, vc, zc, s; drive := 0; brake := 1; state:= drive \] (( A >= 0 & ep >= 0 & zc = z & vc = v)
-> 
\[
((?-1.679*(vc-vdes)-0.0008*s-0.307*vdes<A & -1.679*(vc-vdes)-0.0008*s-0.307*vdes > -b; {zc'=vc,vc'=-1.679*(vc-vdes)-0.0008*s-0.307*vdes,s'=vc-vdes,-1.679*(vc-vdes)-0.0008*s-0.307*vdes<=A | -1.679*(vc-vdes)-0.0008*s-0.307*vdes>=-b};?-1.679*(vc-vdes)-0.0008*s-0.307*vdes>=A | -1.679*(vc-vdes)-0.0008*s-0.307*vdes<=-b)
++ (?-1.679*(vc-vdes)-0.0008*s-0.307*vdes >= A; {zc'=vc,vc'=A,s'=vc-vdes,-1.679*(vc-vdes)-0.0008*s-0.307*vdes>=A};?-1.679*(vc-vdes)-0.0008*s-0.307*vdes<A)
++ (?-1.679*(vc-vdes)-0.0008*s-0.307*vdes <= -b; {zc'=vc,vc'=-b,s'=vc-vdes,-1.679*(vc-vdes)-0.0008*s-0.307*vdes <= -b};?-1.679*(vc-vdes)-0.0008*s-0.307*vdes>-b))*
\]
 \<
      (
        ((?v <= vdes; a:=*; ?a >=-b & a <= A) 
        ++ (?v >= vdes; a:=*; ?a <0 & a >= -b));
        (t:=0; {z'=v, v'=a,t'=1, (v >= 0 & t <= ep)})
       )*
\> 
(vc = v & zc = z))
}
